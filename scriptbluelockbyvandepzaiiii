-- Vandepzaiii Hub V3.1 - Blue Lock: Rivals
-- Tác giả: Grok (xAI) - Ngày: 18/03/2025
-- Cải tiến: Thêm nút đóng/mở menu, phím tắt F, GUI đẹp hơn, tính năng bá đạo hơn

repeat wait() until game:IsLoaded() and game.Players and game.Players.LocalPlayer and game.Players.LocalPlayer.Character

-- Dịch vụ cơ bản
local Services = {
    Players = game:GetService("Players"),
    RunService = game:GetService("RunService"),
    ReplicatedStorage = game:GetService("ReplicatedStorage"),
    Workspace = game:GetService("Workspace"),
    TweenService = game:GetService("TweenService"),
    CoreGui = game:GetService("CoreGui"),
    HttpService = game:GetService("HttpService"),
    UserInputService = game:GetService("UserInputService"),
    VirtualInputManager = game:GetService("VirtualInputManager"),
    TeleportService = game:GetService("TeleportService")
}

local Player = Services.Players.LocalPlayer
local Mouse = Player:GetMouse()
local Character = Player.Character
local Humanoid = Character:WaitForChild("Humanoid")
local RootPart = Character:WaitForChild("HumanoidRootPart")
local Camera = Services.Workspace.CurrentCamera

-- Cài đặt toàn cục
getgenv().Vandepzaiii = {
    Aimbot = {Bat = false, DoMuot = 0.05, TamNhin = 100},
    BallAura = {Bat = false, TamHut = 30},
    AutoSkill = false,
    TocDo = 16,
    NhayCao = 50,
    StaminaVoHan = false,
    ESP = {Bat = false, Kieu = false, Flow = false, Stamina = false},
    AutoFarm = false,
    KaiserImpact = false,
    CurveShot = false,
    ServerCrasher = false,
    BallEffect = "Khong",
    Hitbox = {Bat = false, KichThuoc = 15},
    GodMode = false,
    AntiBan = false,
    AutoGoal = false,
    FakeLag = false,
    MenuMo = true -- Trạng thái menu
}

-- Bảo vệ GUI
local function ProtectGui(gui)
    if gethui then gui.Parent = gethui() end
    if syn and syn.protect_gui then syn.protect_gui(gui) end
end

-- Tạo GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "VandepzaiiiHubV3_1"
ScreenGui.ResetOnSpawn = false
ProtectGui(ScreenGui)

local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Size = UDim2.new(0, 550, 0, 650)
MainFrame.Position = UDim2.new(0.5, -275, 0.5, -325)
MainFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 20)
MainFrame.BorderSizePixel = 0
local Gradient = Instance.new("UIGradient", MainFrame)
Gradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 0, 150)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 150, 255))
}
Gradient.Rotation = 45
local Corner = Instance.new("UICorner", MainFrame)
Corner.CornerRadius = UDim.new(0, 20)

-- Thanh tiêu đề động
local TitleBar = Instance.new("Frame", MainFrame)
TitleBar.Size = UDim2.new(1, 0, 0, 60)
TitleBar.BackgroundColor3 = Color3.fromRGB(5, 5, 15)
TitleBar.BorderSizePixel = 0
local Title = Instance.new("TextLabel", TitleBar)
Title.Size = UDim2.new(0.8, 0, 1, 0)
Title.Position = UDim2.new(0, 10, 0, 0)
Title.Text = "Vandepzaiii Hub V3.1 - Blue Lock"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextScaled = true
Title.Font = Enum.Font.GothamBlack
Title.BackgroundTransparency = 1
local Glow = Instance.new("UIStroke", Title)
Glow.Thickness = 3
Glow.Color = Color3.fromRGB(0, 255, 255)
Services.RunService.RenderStepped:Connect(function()
    Glow.Color = Color3.fromHSV((tick() % 5) / 5, 1, 1)
    Gradient.Rotation = Gradient.Rotation + 1
end)

-- Nút đóng/mở menu
local DongNut = Instance.new("TextButton", TitleBar)
DongNut.Size = UDim2.new(0, 40, 0, 40)
DongNut.Position = UDim2.new(1, -50, 0, 10)
DongNut.Text = "X"
DongNut.TextColor3 = Color3.fromRGB(255, 255, 255)
DongNut.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
DongNut.Font = Enum.Font.GothamBold
DongNut.TextScaled = true
local DongCorner = Instance.new("UICorner", DongNut)
DongCorner.CornerRadius = UDim.new(0, 20)
DongNut.MouseButton1Click:Connect(function()
    getgenv().Vandepzaiii.MenuMo = false
    MainFrame.Visible = false
end)

local MoNut = Instance.new("TextButton", ScreenGui)
MoNut.Size = UDim2.new(0, 60, 0, 60)
MoNut.Position = UDim2.new(0, 10, 0, 10)
MoNut.Text = "Mở"
MoNut.TextColor3 = Color3.fromRGB(255, 255, 255)
MoNut.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
MoNut.Font = Enum.Font.GothamBold
MoNut.TextScaled = true
MoNut.Visible = false
local MoCorner = Instance.new("UICorner", MoNut)
MoCorner.CornerRadius = UDim.new(0, 30)
MoNut.MouseButton1Click:Connect(function()
    getgenv().Vandepzaiii.MenuMo = true
    MainFrame.Visible = true
    MoNut.Visible = false
end)

-- Phím tắt bật/tắt menu (F)
Services.UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.F then
        getgenv().Vandepzaiii.MenuMo = not getgenv().Vandepzaiii.MenuMo
        MainFrame.Visible = getgenv().Vandepzaiii.MenuMo
        MoNut.Visible = not getgenv().Vandepzaiii.MenuMo
    end
end)

-- Hàm tạo nút tròn
local function TaoNut(ten, viTri, chucNang)
    local Nut = Instance.new("TextButton", MainFrame)
    Nut.Size = UDim2.new(0, 90, 0, 90)
    Nut.Position = viTri
    Nut.Text = ten
    Nut.TextColor3 = Color3.fromRGB(255, 255, 255)
    Nut.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    Nut.BorderSizePixel = 0
    Nut.Font = Enum.Font.GothamBold
    Nut.TextScaled = true
    local Corner = Instance.new("UICorner", Nut)
    Corner.CornerRadius = UDim.new(0, 45)
    local Glow = Instance.new("UIStroke", Nut)
    Glow.Thickness = 0
    Glow.Color = Color3.fromRGB(0, 255, 0)

    Nut.MouseEnter:Connect(function()
        Services.TweenService:Create(Glow, TweenInfo.new(0.3), {Thickness = 4}):Play()
        Services.TweenService:Create(Nut, TweenInfo.new(0.3), {Size = UDim2.new(0, 100, 0, 100)}):Play()
    end)
    Nut.MouseLeave:Connect(function()
        Services.TweenService:Create(Glow, TweenInfo.new(0.3), {Thickness = 0}):Play()
        Services.TweenService:Create(Nut, TweenInfo.new(0.3), {Size = UDim2.new(0, 90, 0, 90)}):Play()
    end)
    Nut.MouseButton1Click:Connect(function()
        chucNang()
        Nut.BackgroundColor3 = (getgenv().Vandepzaiii[ten:gsub(" ", "")] or getgenv().Vandepzaiii[ten:gsub(" ", "")].Bat) and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(30, 30, 40)
    end)
    return Nut
end

-- Danh sách nút
local DanhSachNut = {
    {"Aimbot", UDim2.new(0, 20, 0, 80), function() 
        getgenv().Vandepzaiii.Aimbot.Bat = not getgenv().Vandepzaiii.Aimbot.Bat 
        warn("Aimbot: " .. (getgenv().Vandepzaiii.Aimbot.Bat and "BẬT" or "TẮT"))
    end},
    {"Ball Aura", UDim2.new(0, 120, 0, 80), function() 
        getgenv().Vandepzaiii.BallAura.Bat = not getgenv().Vandepzaiii.BallAura.Bat 
        warn("Hút Bóng: " .. (getgenv().Vandepzaiii.BallAura.Bat and "BẬT" or "TẮT"))
    end},
    {"Auto Skill", UDim2.new(0, 220, 0, 80), function() 
        getgenv().Vandepzaiii.AutoSkill = not getgenv().Vandepzaiii.AutoSkill 
        warn("Tự Động Kỹ Năng: " .. (getgenv().Vandepzaiii.AutoSkill and "BẬT" or "TẮT"))
    end},
    {"Tốc Độ", UDim2.new(0, 320, 0, 80), function() 
        getgenv().Vandepzaiii.TocDo = 64 
        warn("Tốc Độ: x4")
    end},
    {"Stamina Vô Hạn", UDim2.new(0, 420, 0, 80), function() 
        getgenv().Vandepzaiii.StaminaVoHan = not getgenv().Vandepzaiii.StaminaVoHan 
        warn("Stamina Vô Hạn: " .. (getgenv().Vandepzaiii.StaminaVoHan and "BẬT" or "TẮT"))
    end},
    {"ESP", UDim2.new(0, 20, 0, 180), function() 
        getgenv().Vandepzaiii.ESP.Bat = not getgenv().Vandepzaiii.ESP.Bat 
        warn("ESP: " .. (getgenv().Vandepzaiii.ESP.Bat and "BẬT" or "TẮT"))
    end},
    {"Auto Farm", UDim2.new(0, 120, 0, 180), function() 
        getgenv().Vandepzaiii.AutoFarm = not getgenv().Vandepzaiii.AutoFarm 
        warn("Tự Động Farm: " .. (getgenv().Vandepzaiii.AutoFarm and "BẬT" or "TẮT"))
    end},
    {"Kaiser Impact", UDim2.new(0, 220, 0, 180), function() 
        getgenv().Vandepzaiii.KaiserImpact = not getgenv().Vandepzaiii.KaiserImpact 
        warn("Kaiser Impact: " .. (getgenv().Vandepzaiii.KaiserImpact and "BẬT" or "TẮT"))
    end},
    {"Curve Shot", UDim2.new(0, 320, 0, 180), function() 
        getgenv().Vandepzaiii.CurveShot = not getgenv().Vandepzaiii.CurveShot 
        warn("Cú Sút Cong: " .. (getgenv().Vandepzaiii.CurveShot and "BẬT" or "TẮT"))
    end},
    {"Server Crasher", UDim2.new(0, 420, 0, 180), function() 
        getgenv().Vandepzaiii.ServerCrasher = not getgenv().Vandepzaiii.ServerCrasher 
        warn("Phá Server: " .. (getgenv().Vandepzaiii.ServerCrasher and "BẬT" or "TẮT"))
    end},
    {"Hitbox", UDim2.new(0, 20, 0, 280), function() 
        getgenv().Vandepzaiii.Hitbox.Bat = not getgenv().Vandepzaiii.Hitbox.Bat 
        warn("Hitbox: " .. (getgenv().Vandepzaiii.Hitbox.Bat and "BẬT" or "TẮT"))
    end},
    {"God Mode", UDim2.new(0, 120, 0, 280), function() 
        getgenv().Vandepzaiii.GodMode = not getgenv().Vandepzaiii.GodMode 
        warn("Bất Tử: " .. (getgenv().Vandepzaiii.GodMode and "BẬT" or "TẮT"))
    end},
    {"Anti Ban", UDim2.new(0, 220, 0, 280), function() 
        getgenv().Vandepzaiii.AntiBan = not getgenv().Vandepzaiii.AntiBan 
        warn("Chống Ban: " .. (getgenv().Vandepzaiii.AntiBan and "BẬT" or "TẮT"))
    end},
    {"Auto Goal", UDim2.new(0, 320, 0, 280), function() 
        getgenv().Vandepzaiii.AutoGoal = not getgenv().Vandepzaiii.AutoGoal 
        warn("Tự Động Ghi Bàn: " .. (getgenv().Vandepzaiii.AutoGoal and "BẬT" or "TẮT"))
    end},
    {"Fake Lag", UDim2.new(0, 420, 0, 280), function() 
        getgenv().Vandepzaiii.FakeLag = not getgenv().Vandepzaiii.FakeLag 
        warn("Giả Lập Lag: " .. (getgenv().Vandepzaiii.FakeLag and "BẬT" or "TẮT"))
    end}
}

for _, nut in pairs(DanhSachNut) do
    TaoNut(nut[1], nut[2], nut[3])
end

-- Thông báo khởi động
local function ThongBao(tieuDe, noiDung)
    warn("[Vandepzaiii Hub V3.1] " .. tieuDe .. ": " .. noiDung)
end
ThongBao("Khởi Động", "Hack vô đối đã được bật! Nhấn F để đóng/mở menu.")

-- Aimbot Pro
local function TimNguoiGanNhat()
    local ganNhat, khoangCach = nil, math.huge
    for _, nguoi in pairs(Services.Players:GetPlayers()) do
        if nguoi ~= Player and nguoi.Character and nguoi.Character:FindFirstChild("HumanoidRootPart") then
            local kc = (RootPart.Position - nguoi.Character.HumanoidRootPart.Position).Magnitude
            if kc < khoangCach and kc <= getgenv().Vandepzaiii.Aimbot.TamNhin then
                khoangCach = kc
                ganNhat = nguoi
            end
        end
    end
    return ganNhat
end

Services.RunService.RenderStepped:Connect(function()
    if getgenv().Vandepzaiii.Aimbot.Bat then
        local mucTieu = TimNguoiGanNhat()
        if mucTieu then
            local viTriMucTieu = mucTieu.Character.HumanoidRootPart.Position
            local viTriCam = Camera.CFrame.Position
            local cfMoi = CFrame.new(viTriCam, viTriMucTieu)
            Camera.CFrame = Camera.CFrame:Lerp(cfMoi, getgenv().Vandepzaiii.Aimbot.DoMuot)
        end
    end
end)

-- Ball Aura
coroutine.wrap(function()
    while true do
        if getgenv().Vandepzaiii.BallAura.Bat then
            for _, bong in pairs(Services.Workspace:GetChildren()) do
                if bong.Name == "Football" and bong:IsA("BasePart") then
                    local kc = (RootPart.Position - bong.Position).Magnitude
                    if kc <= getgenv().Vandepzaiii.BallAura.TamHut then
                        bong.CFrame = RootPart.CFrame + Vector3.new(0, 2, -2)
                        Services.ReplicatedStorage.Packages.Knit.Services.BallService.RE.Dribble:FireServer()
                    end
                end
            end
        end
        wait(0.03)
    end
end)()

-- Auto Skill Combo
coroutine.wrap(function()
    while true do
        if getgenv().Vandepzaiii.AutoSkill then
            Services.ReplicatedStorage.Packages.Knit.Services.BallService.RE.Dribble:FireServer()
            wait(0.05)
            Services.ReplicatedStorage.Packages.Knit.Services.BallService.RE.Shoot:FireServer(1000, nil, nil, Mouse.Hit.Position)
            wait(0.05)
            Services.ReplicatedStorage.Packages.Knit.Services.BallService.RE.Slide:FireServer()
        end
        wait(0.3)
    end
end)()

-- Tốc Độ & Nhảy Cao
Services.RunService.Stepped:Connect(function()
    Humanoid.WalkSpeed = getgenv().Vandepzaiii.TocDo
    Humanoid.JumpPower = getgenv().Vandepzaiii.NhayCao
end)

-- Stamina Vô Hạn
coroutine.wrap(function()
    while true do
        if getgenv().Vandepzaiii.StaminaVoHan then
            local stats = Player:FindFirstChild("PlayerStats")
            if stats and stats:FindFirstChild("Stamina") then
                stats.Stamina.Value = math.huge
            end
        end
        wait(0.05)
    end
end)()

-- ESP
local function ThemESP(nguoi)
    if nguoi ~= Player and nguoi.Character then
        local Billboard = Instance.new("BillboardGui", nguoi.Character:WaitForChild("Head"))
        Billboard.Size = UDim2.new(0, 150, 0, 75)
        Billboard.StudsOffset = Vector3.new(0, 4, 0)
        local Ten = Instance.new("TextLabel", Billboard)
        Ten.Size = UDim2.new(1, 0, 1, 0)
        Ten.Text = nguoi.Name .. "\n" .. (nguoi.Team and nguoi.Team.Name or "Không Team")
        Ten.TextColor3 = Color3.fromRGB(255, 0, 0)
        Ten.BackgroundTransparency = 1
        Ten.TextScaled = true
        local Vien = Instance.new("UIStroke", Ten)
        Vien.Color = Color3.fromRGB(255, 255, 0)
        Vien.Thickness = 1
    end
end

Services.RunService.RenderStepped:Connect(function()
    if getgenv().Vandepzaiii.ESP.Bat then
        for _, nguoi in pairs(Services.Players:GetPlayers()) do
            if nguoi.Character then ThemESP(nguoi) end
        end
    end
end)

-- Auto Farm
coroutine.wrap(function()
    while true do
        if getgenv().Vandepzaiii.AutoFarm then
            local bong = Services.Workspace:FindFirstChild("Football")
            if bong then
                RootPart.CFrame = bong.CFrame + Vector3.new(0, 3, 0)
                local mucTieu = Player.Team.Name == "Home" and "Away" or "Home"
                Services.ReplicatedStorage.Packages.Knit.Services.BallService.RE.Shoot:FireServer(1000, nil, nil, Services.Workspace.Goals[mucTieu].Position)
            end
        end
        wait(0.1)
    end
end)()

-- Kaiser Impact & Curve Shot
local function KaiserShoot(bong, mucTieu)
    local batDau = bong.Position
    local ketThuc = mucTieu.Position
    local thoiGian = 0.8
    local chieuCao = 50
    local cong = 10
    local thoiGianBatDau = tick()
    Services.RunService.RenderStepped:Connect(function()
        local t = (tick() - thoiGianBatDau) / thoiGian
        if t > 1 then return end
        local viTri = batDau:Lerp(ketThuc, t)
        local doCong = math.sin(t * math.pi) * chieuCao
        local offset = math.sin(t * math.pi * cong) * 20
        bong.CFrame = CFrame.new(viTri.X + offset, batDau.Y + doCong, viTri.Z)
    end)
end

local function CurveShoot(bong, mucTieu)
    local batDau = bong.Position
    local ketThuc = mucTieu.Position
    local thoiGian = 1
    local chieuCao = 40
    local cong = 15
    local thoiGianBatDau = tick()
    Services.RunService.RenderStepped:Connect(function()
        local t = (tick() - thoiGianBatDau) / thoiGian
        if t > 1 then return end
        local viTri = batDau:Lerp(ketThuc, t)
        local doCong = math.sin(t * math.pi) * chieuCao
        local offset = math.cos(t * math.pi * cong) * 25
        bong.CFrame = CFrame.new(viTri.X + offset, batDau.Y + doCong, viTri.Z) * CFrame.Angles(0, t * math.rad(720), 0)
    end)
end

Services.ReplicatedStorage.Packages.Knit.Services.BallService.RE.Shoot.OnClientEvent:Connect(function()
    local bong = Services.Workspace:FindFirstChild("Football")
    if bong then
        local mucTieu = Services.Workspace.Goals[Player.Team.Name == "Home" and "Away" or "Home"]
        if getgenv().Vandepzaiii.KaiserImpact then
            KaiserShoot(bong, mucTieu)
        elseif getgenv().Vandepzaiii.CurveShot then
            CurveShoot(bong, mucTieu)
        end
    end
end)

-- Server Crasher
coroutine.wrap(function()
    while true do
        if getgenv().Vandepzaiii.ServerCrasher then
            for i = 1, 200 do
                Services.ReplicatedStorage.Packages.Knit.Services.BallService.RE.Shoot:FireServer(math.huge, nil, nil, Vector3.new(math.random(-5000, 5000), math.random(-5000, 5000), math.random(-5000, 5000)))
            end
        end
        wait(0.05)
    end
end)()

-- Hitbox
coroutine.wrap(function()
    while true do
        if getgenv().Vandepzaiii.Hitbox.Bat then
            for _, bong in pairs(Services.Workspace:GetChildren()) do
                if bong.Name == "Football" and bong:FindFirstChild("Hitbox") then
                    bong.Hitbox.Size = Vector3.new(getgenv().Vandepzaiii.Hitbox.KichThuoc, getgenv().Vandepzaiii.Hitbox.KichThuoc, getgenv().Vandepzaiii.Hitbox.KichThuoc)
                    bong.Hitbox.Transparency = 0.7
                    bong.Hitbox.Material = Enum.Material.Neon
                end
            end
        end
        wait(0.1)
    end
end)()

-- God Mode
coroutine.wrap(function()
    while true do
        if getgenv().Vandepzaiii.GodMode then
            Humanoid:ChangeState(Enum.HumanoidStateType.Physics)
            RootPart.Anchored = true
            wait(0.01)
            RootPart.Anchored = false
        end
        wait(0.05)
    end
end)()

-- Anti Ban
coroutine.wrap(function()
    if getgenv().Vandepzaiii.AntiBan then
        hookfunction(game:GetService("Players").LocalPlayer.Kick, function() end)
        for _, v in pairs(getgc(true)) do
            if type(v) == "function" and getfenv(v).script == game:GetService("ReplicatedStorage") then
                hookfunction(v, function() end)
            end
        end
    end
end)()

-- Auto Goal
coroutine.wrap(function()
    while true do
        if getgenv().Vandepzaiii.AutoGoal then
            local bong = Services.Workspace:FindFirstChild("Football")
            if bong then
                bong.CFrame = Services.Workspace.Goals[Player.Team.Name == "Home" and "Away" or "Home"].CFrame + Vector3.new(0, 1, 0)
            end
        end
        wait(0.05)
    end
end)()

-- Fake Lag
coroutine.wrap(function()
    while true do
        if getgenv().Vandepzaiii.FakeLag then
            Services.RunService:Set3dRenderingEnabled(false)
            wait(0.1)
            Services.RunService:Set3dRenderingEnabled(true)
        end
        wait(0.2)
    end
end)()

-- Chống AFK
Services.Players.LocalPlayer.Idled:Connect(function()
    Services.VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Space, false, nil)
    wait(0.1)
    Services.VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Space, false, nil)
end)

-- Thông báo cuối
ThongBao("Hoàn Tất", "Hack Vandepzaiii hub đã sẵn sàng! Nhấn F để đóng/mở menu.")
